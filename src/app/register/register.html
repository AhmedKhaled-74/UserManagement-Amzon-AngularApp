<div class="container py-4">
  <h1 class="mb-4 text-center">
    <fa-icon [icon]="faUser" class="me-2"></fa-icon> Create Account
  </h1>

  <div *ngIf="registrationSuccess" class="alert alert-success">
    Registration successful! You can now log in.
  </div>

  <div *ngIf="errorMessage" class="alert alert-danger">
    {{ errorMessage }}
  </div>

  <form
    [formGroup]="registerForm"
    (ngSubmit)="onSubmit()"
    class="shadow-sm p-4 rounded bg-light mx-auto"
    style="max-width: 600px"
  >
    <!-- Full Name -->
    <a
      routerLinkActive="active"
      routerLink="/account/login"
      class="link-primary pointer"
      (click)="goLogin()"
      >Have account ? Signin Now</a
    >
    <div class="mb-3">
      <label for="fullName" class="form-label">
        <fa-icon [icon]="faUser" class="me-2"></fa-icon> Full Name
      </label>
      <input
        type="text"
        id="fullName"
        formControlName="fullName"
        class="form-control"
        [ngClass]="{
          'is-invalid': f['fullName'].touched && f['fullName'].errors
        }"
        required
      />
      <div *ngIf="f['fullName'].errors" class="invalid-feedback">
        <div *ngIf="f['fullName'].errors['required']">
          Full name is required
        </div>
        <div *ngIf="f['fullName'].errors['minlength']">
          Full name must be at least 3 characters
        </div>
      </div>
    </div>

    <!-- Email Field -->
    <div class="mb-3">
      <label for="email" class="form-label">
        <fa-icon [icon]="faEnvelope" class="me-2"></fa-icon> Email
      </label>
      <input
        type="email"
        id="email"
        formControlName="email"
        class="form-control"
        [ngClass]="{
          'is-invalid':
            (f['email'].touched || f['email'].dirty) && f['email'].errors
        }"
        required
      />
      <div *ngIf="f['email'].errors" class="invalid-feedback">
        <div *ngIf="f['email'].errors['required']">Email is required</div>
        <div *ngIf="f['email'].errors['email']">Please enter a valid email</div>
        <div *ngIf="f['email'].errors['emailExists']">Email already exists</div>
      </div>
    </div>

    <!-- Password Field -->
    <div class="mb-3">
      <label for="password" class="form-label">
        <fa-icon [icon]="faLock" class="me-2"></fa-icon> Password
      </label>
      <div class="input-group">
        <input
          [type]="showPassword ? 'text' : 'password'"
          id="password"
          formControlName="password"
          class="form-control"
          [ngClass]="{
            'is-invalid':
              (f['password'].touched || f['password'].dirty) &&
              f['password'].errors
          }"
          required
        />
        <button
          class="btn btn-outline-secondary"
          type="button"
          (click)="togglePasswordVisibility()"
        >
          <fa-icon [icon]="showPassword ? faEyeSlash : faEye"></fa-icon>
        </button>
      </div>
      <div *ngIf="f['password'].errors" class="invalid-feedback">
        <div *ngIf="f['password'].errors['required']">Password is required</div>
        <div *ngIf="f['password'].errors['minlength']">
          Password must be at least 6 characters
        </div>
        <div *ngIf="f['password'].errors['maxlength']">
          Password cannot exceed 20 characters
        </div>
        <div *ngIf="f['password'].errors['pattern']">
          Password must contain at least one letter, one number, and one special
          character (_&#64;*-)
        </div>
      </div>
    </div>

    <!-- Confirm Password -->
    <div class="mb-3">
      <label for="confirmPassword" class="form-label">
        <fa-icon [icon]="faLock" class="me-2"></fa-icon> Confirm Password
      </label>
      <div class="input-group">
        <input
          [type]="showPassword ? 'text' : 'password'"
          id="confirmPassword"
          formControlName="confirmPassword"
          class="form-control"
          [ngClass]="{
           'is-invalid':
           f['confirmPassword'].touched &&
           (f['confirmPassword'].errors || registerForm.errors?.['mismatch'])
          }"
          required
        />
        <button
          class="btn btn-outline-secondary"
          type="button"
          (click)="togglePasswordVisibility()"
        >
          <fa-icon [icon]="showPassword ? faEyeSlash : faEye"></fa-icon>
        </button>
      </div>
      <div
        *ngIf="f['confirmPassword'].touched && registerForm.errors?.['mismatch']"
        class="invalid-feedback"
      >
        Passwords do not match
      </div>
    </div>

    <!-- Date of Birth -->
    <div class="mb-3">
      <label for="dateOfBirth" class="form-label">
        <fa-icon [icon]="faCalendar" class="me-2"></fa-icon> Date of Birth
        (Optional)
      </label>
      <input
        type="date"
        id="dateOfBirth"
        formControlName="dateOfBirth"
        class="form-control"
      />
    </div>

    <!-- Region -->
    <div class="mb-3">
      <label for="region" class="form-label">
        <fa-icon [icon]="faGlobe" class="me-2"></fa-icon> Region (Optional)
      </label>
      <input
        type="text"
        id="region"
        formControlName="region"
        class="form-control"
      />
    </div>

    <!-- Phone Number -->
    <div class="mb-3">
      <label for="phoneNumber" class="form-label">
        <fa-icon [icon]="faPhone" class="me-2"></fa-icon> Phone Number
        (Optional)
      </label>
      <input
        type="tel"
        id="phoneNumber"
        formControlName="phoneNumber"
        class="form-control"
      />
    </div>

    <div class="d-grid">
      <button
        type="submit"
        class="btn btn-primary btn-lg"
        [disabled]="registerForm.invalid || isSubmitting"
      >
        <fa-icon [icon]="faCheck" class="me-2"></fa-icon>
        {{ isSubmitting ? "Registering..." : "Register" }}
      </button>
    </div>
  </form>
</div>
